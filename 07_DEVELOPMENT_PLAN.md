# ×ª×›× ×™×ª ×¤×™×ª×•×— ××œ××” - ××¤×œ×™×§×¦×™×™×ª × ×•×›×—×•×ª ×”×•×¨×™×ª (Parental Presence App)

## ğŸ¯ ×¡×§×™×¨×ª ×”×¤×¨×•×™×§×˜

**×©× ××•×¦×¢**: "HereForYou" / "×›××Ÿ ×‘×©×‘×™×œ×š"

**×™×™×¢×•×“**: ××¤×œ×™×§×¦×™×” cross-platform ×©×¢×•×–×¨×ª ×œ×”×•×¨×™× ×œ×”×™×•×ª ××•×“×¢×™× ×•× ×•×›×—×™× ×¢× ×™×œ×“×™×”× ×¢×œ ×™×“×™ ×–×™×”×•×™ ×¤× ×™×•×ª, × ×™×˜×•×¨ ×–××Ÿ ××¡×š, ×•××ª×Ÿ ×ª×•×‘× ×•×ª ×¢×œ ××™×›×•×ª ×”×–××Ÿ ×”××©×¤×—×ª×™.

**×¤×œ×˜×¤×•×¨××•×ª ×™×¢×“**: Android, iOS, Windows, macOS

---

## ğŸ“š ×¡×˜×§ ×˜×›× ×•×œ×•×’×™ ××•××œ×¥ (××•×ª×× ×œ-C# Developer)

### Frontend - .NET MAUI
**×œ××” ×–×” ××•×©×œ× ×‘×©×‘×™×œ×š:**
- **C# ×˜×”×•×¨** - ××•×ª×” ×©×¤×” ×©××ª×” ××›×™×¨
- **XAML** ×œ×××©×§ - ×“×•××” ×œ-WPF ×× ×”×›×¨×ª
- **Cross-platform ×××™×ª×™** - ×§×•×“ ××—×“ ×œ×›×œ ×”×¤×œ×˜×¤×•×¨××•×ª
- **×’×™×©×” native** ×œ×›×œ ×¤×™×¦'×¨×™× ×©×œ ×”××›×©×™×¨
- **Community Package Ecosystem** (.NET NuGet)

### Backend (××•×¤×¦×™×•× ×œ×™ - ×× ×ª×¨×¦×” sync ×‘×¢× ×Ÿ)
- **ASP.NET Core Web API** - ×”×™×“×¢ ×©×œ×š ×™×©×™×¨×•×ª
- **SignalR** ×œ×¢×“×›×•× ×™× ×‘×–××Ÿ ×××ª (×œ××©×œ sync ×‘×™×Ÿ ×‘× ×™ ×–×•×’)
- **SQLite** ×œ-local storage
- **Azure/AWS** ×¨×§ ×× ×¦×¨×™×š ×¢× ×Ÿ (××‘×œ × × ×¡×” ×œ×”×™×©××¨ local-first)

### ×›×œ×™ ×–×™×”×•×™ ×§×•×œ
- **Picovoice Porcupine** - ×–×™×”×•×™ wake words (×™×© .NET SDK!)
- **Vosk** - transcription offline (×™×© C# wrapper)
- **Microsoft Azure Speech SDK** - ×—×œ×•×¤×” ×× ×¨×•×¦×™× cloud-based (××‘×œ ×¤×—×•×ª ××•××œ×¥ ×œ×¤×¨×˜×™×•×ª)

### Database & Storage
- **SQLite-net-pcl** - SQLite ×œ-MAUI
- **Akavache** - caching reactive (×× ×¨×•×¦×™× advanced)
- **SecureStorage** ××•×‘× ×” ×‘-MAUI ×œ×¡×•×“×•×ª

### × ×™×˜×•×¨ ××¡×š
- **Android**: UsageStatsManager + AccessibilityService
- **iOS**: Screen Time API (××•×’×‘×œ ×××•×“! × ×“×‘×¨ ×¢×œ ×–×”)
- **Windows**: Win32 APIs ×“×¨×š Platform-Specific Code
- **×›×•×œ×**: MAUI Community Toolkit

### State Management
- **MVVM Pattern** - × ×ª××š ××¦×•×™×Ÿ ×‘-MAUI
- **CommunityToolkit.Mvvm** - ×”×¤×©×˜×” ×§×œ×” ×©×œ MVVM
- **ReactiveUI** ×× ××ª×” ××•×”×‘ Reactive Programming

---

## ğŸ—ï¸ ××¨×›×™×˜×§×˜×•×¨×” ×›×œ×œ×™×ª

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MAUI UI Layer (XAML/C#)              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Home View   â”‚  â”‚ Insights Viewâ”‚  â”‚ Settings Viewâ”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ViewModels (MVVM Pattern)                   â”‚
â”‚  - HomeViewModel                                         â”‚
â”‚  - InsightsViewModel                                     â”‚
â”‚  - SettingsViewModel                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Services Layer                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ Audio Monitor      â”‚  â”‚ Screen Time        â”‚        â”‚
â”‚  â”‚ Service            â”‚  â”‚ Monitor Service    â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ Notification       â”‚  â”‚ Analytics          â”‚        â”‚
â”‚  â”‚ Service            â”‚  â”‚ Service            â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Platform-Specific Layer                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Android     â”‚  â”‚     iOS      â”‚  â”‚   Windows    â”‚  â”‚
â”‚  â”‚  Handlers    â”‚  â”‚   Handlers   â”‚  â”‚   Handlers   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Native SDKs & APIs                            â”‚
â”‚  - Picovoice (voice detection)                          â”‚
â”‚  - Platform permissions                                  â”‚
â”‚  - Background services                                   â”‚
â”‚  - Local notifications                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Local Database (SQLite)                         â”‚
â”‚  - Detection events                                      â”‚
â”‚  - Screen time logs                                      â”‚
â”‚  - User settings                                         â”‚
â”‚  - Analytics data                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ ×ª×›× ×™×ª ×¤×™×ª×•×— ×‘×©×œ×‘×™× (6 ×—×•×“×©×™× ×œ-MVP ××œ×)

### Phase 0: ×”×›× ×” ×•×¡×‘×™×‘×ª ×¤×™×ª×•×— (×©×‘×•×¢ 1)

**××˜×¨×•×ª:**
- ×”×§××ª ×¡×‘×™×‘×ª ×¤×™×ª×•×—
- ×”×‘× ×ª ×”×›×œ×™×
- ×¤×¨×•×™×§×˜ ×¨××©×•×Ÿ ×¤×©×•×˜

**××©×™××•×ª:**
1. ×”×ª×§× ×ª Visual Studio 2022 (×—×•×‘×” ×”×’×¨×¡×” ×”××—×¨×•× ×”)
   - Workload: .NET Multi-platform App UI development
   - Android SDK
   - iOS SDK (×× ×™×© Mac)

2. ×¤×¨×•×™×§×˜ Hello World ×‘-MAUI
   - ×™×¦×™×¨×ª ×¤×¨×•×™×§×˜ ×—×“×©: File â†’ New â†’ .NET MAUI App
   - ×”×¨×¦×” ×¢×œ Android Emulator
   - ×”×¨×¦×” ×¢×œ Windows
   - ×”×‘× ×ª ×”××‘× ×”: Views, ViewModels, Services

3. ×œ××™×“×” ×‘×¡×™×¡×™×ª:
   - Microsoft Learn: .NET MAUI Tutorials
   - ×”×‘× ×ª MVVM Pattern
   - ×”×‘× ×ª Dependency Injection ×‘-MAUI

**×ª×•×¦×¨:** ××¤×œ×™×§×¦×™×™×ª Hello World ×¨×¦×” ×¢×œ ×××•×œ×˜×•×¨

---

### Phase 1: MVP - ×–×™×”×•×™ ×§×•×œ ×‘×¡×™×¡×™ (×©×‘×•×¢×•×ª 2-4)

**××˜×¨×•×ª:**
- ×–×™×”×•×™ ××™×œ×” ××—×ª ("×××" ××• "××‘×")
- ×”×ª×¨××” ×¤×©×•×˜×” ××—×¨×™ 3 ×–×™×”×•×™×™×
- UI ×‘×¡×™×¡×™

#### Week 2: ×”×§××ª ×”×ª×©×ª×™×ª

**××©×™××•×ª ×˜×›× ×™×•×ª:**

**1.1 ×™×¦×™×¨×ª ××‘× ×” ×”×¤×¨×•×™×§×˜**
```
HereForYou/
â”œâ”€â”€ HereForYou/                    # Shared Code
â”‚   â”œâ”€â”€ Models/
â”‚   â”‚   â”œâ”€â”€ DetectionEvent.cs
â”‚   â”‚   â””â”€â”€ AppSettings.cs
â”‚   â”œâ”€â”€ Services/
â”‚   â”‚   â”œâ”€â”€ IAudioMonitorService.cs
â”‚   â”‚   â””â”€â”€ INotificationService.cs
â”‚   â”œâ”€â”€ ViewModels/
â”‚   â”‚   â””â”€â”€ MainViewModel.cs
â”‚   â”œâ”€â”€ Views/
â”‚   â”‚   â””â”€â”€ MainPage.xaml
â”‚   â””â”€â”€ App.xaml
â”œâ”€â”€ Platforms/
â”‚   â”œâ”€â”€ Android/
â”‚   â”‚   â”œâ”€â”€ Services/
â”‚   â”‚   â”‚   â””â”€â”€ AndroidAudioMonitorService.cs
â”‚   â”‚   â””â”€â”€ MainActivity.cs
â”‚   â”œâ”€â”€ iOS/
â”‚   â”‚   â””â”€â”€ Services/
â”‚   â”‚       â””â”€â”€ iOSAudioMonitorService.cs
â”‚   â””â”€â”€ Windows/
â””â”€â”€ HereForYou.csproj
```

**1.2 ×”×’×“×¨×ª Models**

`Models/DetectionEvent.cs`:
```csharp
public class DetectionEvent
{
    public int Id { get; set; }
    public DateTime Timestamp { get; set; }
    public string Keyword { get; set; }  // "×××", "××‘×"
    public float Confidence { get; set; }
    public bool WasRespondedTo { get; set; }
    public TimeSpan? ResponseTime { get; set; }
}
```

`Models/AppSettings.cs`:
```csharp
public class AppSettings
{
    public List<string> Keywords { get; set; } = new() { "×××", "××‘×" };
    public int DetectionThreshold { get; set; } = 3;  // ×›××” ×¤×¢××™× ×¦×¨×™×š ×œ×–×”×•×ª
    public TimeSpan ThresholdWindow { get; set; } = TimeSpan.FromSeconds(30);
    public bool IsMonitoringEnabled { get; set; } = false;
}
```

**1.3 ×™×¦×™×¨×ª Services Interfaces**

`Services/IAudioMonitorService.cs`:
```csharp
public interface IAudioMonitorService
{
    Task<bool> StartMonitoringAsync();
    Task StopMonitoringAsync();
    bool IsMonitoring { get; }
    
    event EventHandler<DetectionEvent> KeywordDetected;
    event EventHandler<string> ErrorOccurred;
}
```

`Services/INotificationService.cs`:
```csharp
public interface INotificationService
{
    Task ShowAlertAsync(string title, string message, AlertLevel level);
    Task<bool> RequestPermissionsAsync();
}

public enum AlertLevel
{
    Info,
    Warning,
    Critical
}
```

#### Week 3: ××™× ×˜×’×¨×¦×™×” ×¢× Picovoice (Android ×‘×œ×‘×“ ×‘×©×œ×‘ ×–×”)

**3.1 ×”×ª×§× ×ª Picovoice NuGet Package**
```bash
Install-Package Picovoice.Porcupine
```

**3.2 ×™×¦×™×¨×ª Android Audio Monitor Service**

`Platforms/Android/Services/AndroidAudioMonitorService.cs`:
```csharp
using Picovoice;
using Android.Media;

public class AndroidAudioMonitorService : IAudioMonitorService
{
    private PorcupineManager _porcupineManager;
    private bool _isMonitoring;
    
    public bool IsMonitoring => _isMonitoring;
    
    public event EventHandler<DetectionEvent> KeywordDetected;
    public event EventHandler<string> ErrorOccurred;
    
    public async Task<bool> StartMonitoringAsync()
    {
        try
        {
            // ×¨×™×©×•× ×œ××¤×ª×— API ×©×œ Picovoice (×™×© tier ×—×™× ××™)
            string accessKey = "YOUR_PICOVOICE_ACCESS_KEY";
            
            // ×™×¦×™×¨×ª ××™×œ×•×ª ××¤×ª×— ××•×ª×××•×ª ××™×©×™×ª
            // ××¤×©×¨ ×œ×™×¦×•×¨ ×‘-Picovoice Console: https://console.picovoice.ai/
            List<string> keywordPaths = new()
            {
                "path/to/ima_android.ppn",    // ×§×•×‘×¥ ××•×“×œ ×œ"×××"
                "path/to/abba_android.ppn"    // ×§×•×‘×¥ ××•×“×œ ×œ"××‘×"
            };
            
            _porcupineManager = new PorcupineManager.Builder()
                .SetAccessKey(accessKey)
                .SetKeywordPaths(keywordPaths.ToArray())
                .SetSensitivities(new float[] { 0.7f, 0.7f })  // ×¨×’×™×©×•×ª ×–×™×”×•×™
                .Build(
                    (keywordIndex) => OnKeywordDetected(keywordIndex)
                );
            
            _porcupineManager.Start();
            _isMonitoring = true;
            
            return true;
        }
        catch (Exception ex)
        {
            ErrorOccurred?.Invoke(this, ex.Message);
            return false;
        }
    }
    
    private void OnKeywordDetected(int keywordIndex)
    {
        string keyword = keywordIndex == 0 ? "×××" : "××‘×";
        
        var detectionEvent = new DetectionEvent
        {
            Timestamp = DateTime.Now,
            Keyword = keyword,
            Confidence = 0.9f,  // Porcupine ×œ× ××—×–×™×¨ confidence, ××‘×œ ××¤×©×¨ ×œ×”× ×™×— ×’×‘×•×”
            WasRespondedTo = false
        };
        
        KeywordDetected?.Invoke(this, detectionEvent);
    }
    
    public async Task StopMonitoringAsync()
    {
        _porcupineManager?.Stop();
        _porcupineManager?.Delete();
        _isMonitoring = false;
    }
}
```

**3.3 ×¨×™×©×•× ×”-Service ×‘-Dependency Injection**

`MauiProgram.cs`:
```csharp
public static class MauiProgram
{
    public static MauiApp CreateMauiApp()
    {
        var builder = MauiApp.CreateBuilder();
        builder
            .UseMauiApp<App>()
            .ConfigureFonts(fonts =>
            {
                fonts.AddFont("OpenSans-Regular.ttf", "OpenSansRegular");
            });
        
        // Register services
#if ANDROID
        builder.Services.AddSingleton<IAudioMonitorService, AndroidAudioMonitorService>();
#elif IOS
        builder.Services.AddSingleton<IAudioMonitorService, iOSAudioMonitorService>();
#endif
        
        builder.Services.AddSingleton<INotificationService, NotificationService>();
        builder.Services.AddTransient<MainViewModel>();
        builder.Services.AddTransient<MainPage>();
        
        return builder.Build();
    }
}
```

**3.4 ×”×’×“×¨×ª ×”×¨×©××•×ª Android**

`Platforms/Android/AndroidManifest.xml`:
```xml
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android">
    <application android:allowBackup="true" android:icon="@mipmap/appicon" android:supportsRtl="true"></application>
    
    <!-- ×”×¨×©××•×ª × ×“×¨×©×•×ª -->
    <uses-permission android:name="android.permission.RECORD_AUDIO" />
    <uses-permission android:name="android.permission.FOREGROUND_SERVICE" />
    <uses-permission android:name="android.permission.POST_NOTIFICATIONS" />
    <uses-permission android:name="android.permission.SYSTEM_ALERT_WINDOW" />
    
    <uses-sdk android:minSdkVersion="24" android:targetSdkVersion="33" />
</manifest>
```

#### Week 4: UI ×¨××©×•× ×™ ×•×œ×•×’×™×§×ª ×”×”×ª×¨××•×ª

**4.1 ×™×¦×™×¨×ª MainViewModel**

`ViewModels/MainViewModel.cs`:
```csharp
using CommunityToolkit.Mvvm.ComponentModel;
using CommunityToolkit.Mvvm.Input;

public partial class MainViewModel : ObservableObject
{
    private readonly IAudioMonitorService _audioMonitor;
    private readonly INotificationService _notificationService;
    private readonly Queue<DetectionEvent> _recentDetections = new();
    
    [ObservableProperty]
    private bool isMonitoring;
    
    [ObservableProperty]
    private int detectionCount;
    
    [ObservableProperty]
    private string statusMessage = "×œ× ×¤×¢×™×œ";
    
    public MainViewModel(
        IAudioMonitorService audioMonitor,
        INotificationService notificationService)
    {
        _audioMonitor = audioMonitor;
        _notificationService = notificationService;
        
        _audioMonitor.KeywordDetected += OnKeywordDetected;
    }
    
    [RelayCommand]
    private async Task ToggleMonitoring()
    {
        if (IsMonitoring)
        {
            await _audioMonitor.StopMonitoringAsync();
            IsMonitoring = false;
            StatusMessage = "× ×™×˜×•×¨ ×”×•×¤×¡×§";
        }
        else
        {
            var hasPermission = await CheckAndRequestPermissions();
            if (!hasPermission)
            {
                await _notificationService.ShowAlertAsync(
                    "×”×¨×©××•×ª ×—×¡×¨×•×ª",
                    "×”××¤×œ×™×§×¦×™×” ×¦×¨×™×›×” ×’×™×©×” ×œ××™×§×¨×•×¤×•×Ÿ",
                    AlertLevel.Warning
                );
                return;
            }
            
            var started = await _audioMonitor.StartMonitoringAsync();
            if (started)
            {
                IsMonitoring = true;
                StatusMessage = "×××–×™×Ÿ...";
            }
        }
    }
    
    private void OnKeywordDetected(object sender, DetectionEvent e)
    {
        // ×”×•×¡×¤×” ×œ×ª×•×¨
        _recentDetections.Enqueue(e);
        
        // × ×™×§×•×™ ×–×™×”×•×™×™× ×™×©× ×™× (××¢×‘×¨ ×œ×—×œ×•×Ÿ ×”×–××Ÿ)
        var threshold = DateTime.Now - TimeSpan.FromSeconds(30);
        while (_recentDetections.Count > 0 && 
               _recentDetections.Peek().Timestamp < threshold)
        {
            _recentDetections.Dequeue();
        }
        
        DetectionCount = _recentDetections.Count;
        
        // ×× ×”×’×¢× ×• ×œ×¡×£ - ×”×ª×¨××”!
        if (DetectionCount >= 3)
        {
            MainThread.BeginInvokeOnMainThread(async () =>
            {
                await _notificationService.ShowAlertAsync(
                    "×”×™×œ×“ ×©×œ×š ×§×•×¨× ×œ×š! ğŸ‘¶",
                    $"{e.Keyword} × ×××¨ {DetectionCount} ×¤×¢××™×",
                    AlertLevel.Critical
                );
            });
            
            // ××™×¤×•×¡
            _recentDetections.Clear();
            DetectionCount = 0;
        }
    }
    
    private async Task<bool> CheckAndRequestPermissions()
    {
        var status = await Permissions.CheckStatusAsync<Permissions.Microphone>();
        
        if (status != PermissionStatus.Granted)
        {
            status = await Permissions.RequestAsync<Permissions.Microphone>();
        }
        
        return status == PermissionStatus.Granted;
    }
}
```

**4.2 ×™×¦×™×¨×ª MainPage UI**

`Views/MainPage.xaml`:
```xml
<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:HereForYou.ViewModels"
             x:Class="HereForYou.MainPage"
             x:DataType="vm:MainViewModel"
             Title="×›××Ÿ ×‘×©×‘×™×œ×š">
    
    <ScrollView>
        <VerticalStackLayout Spacing="25" Padding="30">
            
            <!-- ×›×•×ª×¨×ª -->
            <Label Text="ğŸ‘‚ ×›××Ÿ ×‘×©×‘×™×œ×š"
                   FontSize="32"
                   FontAttributes="Bold"
                   HorizontalOptions="Center" />
            
            <!-- ×¡×˜×˜×•×¡ -->
            <Frame BackgroundColor="{AppThemeBinding Light={StaticResource Primary}, Dark={StaticResource PrimaryDark}}"
                   CornerRadius="10"
                   Padding="20">
                <VerticalStackLayout Spacing="10">
                    <Label Text="{Binding StatusMessage}"
                           FontSize="20"
                           HorizontalOptions="Center"
                           TextColor="White" />
                    
                    <Label Text="{Binding DetectionCount, StringFormat='×–×™×”×•×™×™× ××—×¨×•× ×™×: {0}'}"
                           FontSize="16"
                           HorizontalOptions="Center"
                           TextColor="White" />
                </VerticalStackLayout>
            </Frame>
            
            <!-- ×›×¤×ª×•×¨ ×”×¤×¢×œ×”/×›×™×‘×•×™ -->
            <Button Text="{Binding IsMonitoring, Converter={StaticResource MonitoringTextConverter}}"
                    Command="{Binding ToggleMonitoringCommand}"
                    HeightRequest="60"
                    FontSize="18"
                    BackgroundColor="{Binding IsMonitoring, Converter={StaticResource MonitoringColorConverter}}" />
            
            <!-- ×”×¡×‘×¨ -->
            <Frame BackgroundColor="{AppThemeBinding Light=#F5F5F5, Dark=#2C2C2C}"
                   CornerRadius="10"
                   Padding="15">
                <Label TextType="Html">
                    <Label.Text>
                        <![CDATA[
                        <h3>××™×š ×–×” ×¢×•×‘×“?</h3>
                        <p>×”××¤×œ×™×§×¦×™×” ×××–×™× ×” ×œ××™×œ×•×ª ×”××¤×ª×—:</p>
                        <ul>
                            <li>×××</li>
                            <li>××‘×</li>
                        </ul>
                        <p>×›×©×”××™×œ×” × ×××¨×ª 3 ×¤×¢××™× ×ª×•×š 30 ×©× ×™×•×ª, ×ª×§×‘×œ ×”×ª×¨××”.</p>
                        <p><b>×”×¤×¨×˜×™×•×ª ×©×œ×š ××•×’× ×ª:</b> ×”×–×™×”×•×™ ××ª×‘×¦×¢ ×‘××›×©×™×¨ ×©×œ×š ×‘×œ×‘×“.</p>
                        ]]>
                    </Label.Text>
                </Label>
            </Frame>
            
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
```

**×ª×•×¦×¨ Phase 1:**
âœ… ××¤×œ×™×§×¦×™×” ×©××–×”×” "×××" ××• "××‘×"
âœ… ×”×ª×¨××” ××—×¨×™ 3 ×–×™×”×•×™×™× ×ª×•×š 30 ×©× ×™×•×ª
âœ… UI ×¤×©×•×˜ ×•×¤×•× ×§×¦×™×•× ×œ×™
âœ… ×¨×¥ ×¢×œ Android

---

### Phase 2: × ×™×˜×•×¨ ×–××Ÿ ××¡×š ×‘×¡×™×¡×™ (×©×‘×•×¢×•×ª 5-7)

**××˜×¨×•×ª:**
- ××¢×§×‘ ××—×¨ ×–××Ÿ ×©×”××¤×œ×™×§×¦×™×” ×¤×¢×™×œ×”/×œ× ×¤×¢×™×œ×”
- ×©××™×¨×ª × ×ª×•× ×™× ×‘-SQLite
- ×ª×¦×•×’×ª ×”×™×¡×˜×•×¨×™×” ×‘×¡×™×¡×™×ª

#### Week 5: ×”×’×“×¨×ª Database

**5.1 ×”×ª×§× ×ª SQLite Package**
```bash
Install-Package sqlite-net-pcl
Install-Package SQLitePCLRaw.bundle_green
```

**5.2 ×™×¦×™×¨×ª Database Models**

`Models/ScreenTimeSession.cs`:
```csharp
using SQLite;

[Table("screen_time_sessions")]
public class ScreenTimeSession
{
    [PrimaryKey, AutoIncrement]
    public int Id { get; set; }
    
    [Indexed]
    public DateTime StartTime { get; set; }
    
    public DateTime? EndTime { get; set; }
    
    public TimeSpan Duration => EndTime.HasValue 
        ? EndTime.Value - StartTime 
        : DateTime.Now - StartTime;
    
    public string AppName { get; set; }  // ×œ×¢×ª×™×“ - ××™×–×” ××¤×œ×™×§×¦×™×”
    
    public bool WasInterrupted { get; set; }  // ×”×× ×”×™×” ×–×™×”×•×™ ×‘×–××Ÿ ×”×©×™××•×©
}
```

**5.3 ×™×¦×™×¨×ª Database Service**

`Services/DatabaseService.cs`:
```csharp
using SQLite;

public class DatabaseService
{
    private readonly SQLiteAsyncConnection _database;
    
    public DatabaseService(string dbPath)
    {
        _database = new SQLiteAsyncConnection(dbPath);
        _database.CreateTableAsync<DetectionEvent>().Wait();
        _database.CreateTableAsync<ScreenTimeSession>().Wait();
    }
    
    // Detection Events
    public Task<List<DetectionEvent>> GetDetectionEventsAsync(DateTime from, DateTime to)
    {
        return _database.Table<DetectionEvent>()
            .Where(e => e.Timestamp >= from && e.Timestamp <= to)
            .ToListAsync();
    }
    
    public Task<int> SaveDetectionEventAsync(DetectionEvent detectionEvent)
    {
        if (detectionEvent.Id != 0)
            return _database.UpdateAsync(detectionEvent);
        else
            return _database.InsertAsync(detectionEvent);
    }
    
    // Screen Time
    public Task<List<ScreenTimeSession>> GetScreenTimeSessionsAsync(DateTime date)
    {
        var startOfDay = date.Date;
        var endOfDay = startOfDay.AddDays(1);
        
        return _database.Table<ScreenTimeSession>()
            .Where(s => s.StartTime >= startOfDay && s.StartTime < endOfDay)
            .ToListAsync();
    }
    
    public Task<int> SaveScreenTimeSessionAsync(ScreenTimeSession session)
    {
        if (session.Id != 0)
            return _database.UpdateAsync(session);
        else
            return _database.InsertAsync(session);
    }
    
    public async Task<TimeSpan> GetTotalScreenTimeAsync(DateTime date)
    {
        var sessions = await GetScreenTimeSessionsAsync(date);
        return TimeSpan.FromTicks(sessions.Sum(s => s.Duration.Ticks));
    }
}
```

#### Week 6-7: ××™× ×˜×’×¨×¦×™×” ×¢× Android Usage Stats

**6.1 ×™×¦×™×¨×ª Screen Monitor Service - Android**

`Platforms/Android/Services/AndroidScreenMonitorService.cs`:
```csharp
using Android.App;
using Android.App.Usage;
using Android.Content;

public class AndroidScreenMonitorService : IScreenMonitorService
{
    private readonly Context _context;
    private readonly DatabaseService _database;
    private ScreenTimeSession _currentSession;
    private System.Timers.Timer _monitorTimer;
    
    public AndroidScreenMonitorService(DatabaseService database)
    {
        _database = database;
        _context = Android.App.Application.Context;
    }
    
    public async Task StartMonitoringAsync()
    {
        // ×‘×“×™×§×ª ×”×¨×©××•×ª
        if (!HasUsageStatsPermission())
        {
            RequestUsageStatsPermission();
            return;
        }
        
        // ×”×ª×—×œ×ª ×¡×©×Ÿ ×—×“×©
        _currentSession = new ScreenTimeSession
        {
            StartTime = DateTime.Now,
            AppName = "General",
            WasInterrupted = false
        };
        
        await _database.SaveScreenTimeSessionAsync(_currentSession);
        
        // ×˜×™×™××¨ ×œ×¢×“×›×•×Ÿ ×ª×§×•×¤×ª×™
        _monitorTimer = new System.Timers.Timer(60000); // ×›×œ ×“×§×”
        _monitorTimer.Elapsed += async (s, e) => await UpdateCurrentSession();
        _monitorTimer.Start();
    }
    
    public async Task StopMonitoringAsync()
    {
        _monitorTimer?.Stop();
        
        if (_currentSession != null)
        {
            _currentSession.EndTime = DateTime.Now;
            await _database.SaveScreenTimeSessionAsync(_currentSession);
            _currentSession = null;
        }
    }
    
    private async Task UpdateCurrentSession()
    {
        if (_currentSession != null)
        {
            await _database.SaveScreenTimeSessionAsync(_currentSession);
        }
    }
    
    private bool HasUsageStatsPermission()
    {
        var usageStatsManager = (UsageStatsManager)_context
            .GetSystemService(Context.UsageStatsService);
        
        var endTime = DateTimeOffset.Now.ToUnixTimeMilliseconds();
        var startTime = endTime - 1000 * 60; // ×“×§×” ××—×¨×•× ×”
        
        var queryUsageStats = usageStatsManager.QueryUsageStats(
            UsageStatsInterval.Daily, 
            startTime, 
            endTime
        );
        
        return queryUsageStats != null && queryUsageStats.Count > 0;
    }
    
    private void RequestUsageStatsPermission()
    {
        var intent = new Intent(Android.Provider.Settings.ActionUsageAccessSettings);
        intent.SetFlags(ActivityFlags.NewTask);
        _context.StartActivity(intent);
    }
    
    public async Task<TimeSpan> GetTodayScreenTimeAsync()
    {
        return await _database.GetTotalScreenTimeAsync(DateTime.Today);
    }
}
```

**×ª×•×¦×¨ Phase 2:**
âœ… ××¢×§×‘ ××—×¨ ×–××Ÿ ×©×™××•×© ×‘××›×©×™×¨
âœ… ×©××™×¨×” ×‘-SQLite
âœ… API ×œ×©××™×œ×ª×ª × ×ª×•× ×™×

---

### Phase 3: ×ª×•×‘× ×•×ª ×•×•×™×–×•××œ×™×–×¦×™×” (×©×‘×•×¢×•×ª 8-10)

**××˜×¨×•×ª:**
- ×“×£ Insights ×¢× ×’×¨×¤×™×
- ×¡×˜×˜×™×¡×˜×™×§×•×ª ×™×•××™×•×ª/×©×‘×•×¢×™×•×ª
- "××™× ×“×§×¡ × ×•×›×—×•×ª"

#### Week 8: ×™×¦×™×¨×ª Insights ViewModel

`ViewModels/InsightsViewModel.cs`:
```csharp
using CommunityToolkit.Mvvm.ComponentModel;
using LiveChartsCore;
using LiveChartsCore.SkiaSharpView;

public partial class InsightsViewModel : ObservableObject
{
    private readonly DatabaseService _database;
    
    [ObservableProperty]
    private TimeSpan todayScreenTime;
    
    [ObservableProperty]
    private int todayDetections;
    
    [ObservableProperty]
    private int respondedDetections;
    
    [ObservableProperty]
    private double presenceScore;  // 0-100
    
    [ObservableProperty]
    private ISeries[] screenTimeSeries;
    
    public InsightsViewModel(DatabaseService database)
    {
        _database = database;
    }
    
    public async Task LoadDataAsync()
    {
        // × ×ª×•× ×™ ×”×™×•×
        TodayScreenTime = await _database.GetTotalScreenTimeAsync(DateTime.Today);
        
        var todayDetectionEvents = await _database.GetDetectionEventsAsync(
            DateTime.Today, 
            DateTime.Now
        );
        
        TodayDetections = todayDetectionEvents.Count;
        RespondedDetections = todayDetectionEvents.Count(d => d.WasRespondedTo);
        
        // ×—×™×©×•×‘ Presence Score
        PresenceScore = CalculatePresenceScore(TodayScreenTime, todayDetectionEvents);
        
        // × ×ª×•× ×™× ×œ×’×¨×£ ×©×‘×•×¢×™
        await LoadWeeklyChartData();
    }
    
    private double CalculatePresenceScore(
        TimeSpan screenTime, 
        List<DetectionEvent> detections)
    {
        // ×œ×•×’×™×§×” ×¤×©×•×˜×”:
        // 100 × ×§×•×“×•×ª ×‘×¡×™×¡
        // -10 × ×§×•×“×•×ª ×œ×›×œ ×©×¢×ª ××¡×š ××¢×œ 4 ×©×¢×•×ª
        // -5 × ×§×•×“×•×ª ×œ×›×œ ×–×™×”×•×™ ×œ× ××˜×•×¤×œ
        
        double score = 100;
        
        var excessHours = Math.Max(0, screenTime.TotalHours - 4);
        score -= excessHours * 10;
        
        var unanswered = detections.Count(d => !d.WasRespondedTo);
        score -= unanswered * 5;
        
        return Math.Max(0, Math.Min(100, score));
    }
    
    private async Task LoadWeeklyChartData()
    {
        var weekData = new List<double>();
        
        for (int i = 6; i >= 0; i--)
        {
            var date = DateTime.Today.AddDays(-i);
            var screenTime = await _database.GetTotalScreenTimeAsync(date);
            weekData.Add(screenTime.TotalHours);
        }
        
        ScreenTimeSeries = new ISeries[]
        {
            new ColumnSeries<double>
            {
                Name = "×©×¢×•×ª ××¡×š",
                Values = weekData,
                Fill = new SolidColorPaint(SKColors.CornflowerBlue)
            }
        };
    }
}
```

#### Week 9-10: ×‘× ×™×™×ª Insights UI

`Views/InsightsPage.xaml`:
```xml
<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:HereForYou.ViewModels"
             xmlns:lvc="clr-namespace:LiveChartsCore.SkiaSharpView.Maui;assembly=LiveChartsCore.SkiaSharpView.Maui"
             x:Class="HereForYou.Views.InsightsPage"
             x:DataType="vm:InsightsViewModel"
             Title="×ª×•×‘× ×•×ª">
    
    <ScrollView>
        <VerticalStackLayout Spacing="20" Padding="20">
            
            <!-- Presence Score -->
            <Frame BackgroundColor="{StaticResource Primary}" 
                   CornerRadius="15" 
                   Padding="20">
                <VerticalStackLayout Spacing="10">
                    <Label Text="××“×“ ×”× ×•×›×—×•×ª ×©×œ×š" 
                           FontSize="18" 
                           TextColor="White"
                           HorizontalOptions="Center" />
                    
                    <Label Text="{Binding PresenceScore, StringFormat='{0:F0}'}" 
                           FontSize="48" 
                           FontAttributes="Bold"
                           TextColor="White"
                           HorizontalOptions="Center" />
                    
                    <ProgressBar Progress="{Binding PresenceScore, Converter={StaticResource ScoreToProgressConverter}}"
                                 ProgressColor="White" />
                    
                    <Label Text="{Binding PresenceScore, Converter={StaticResource ScoreToTextConverter}}"
                           FontSize="14"
                           TextColor="White"
                           HorizontalOptions="Center" />
                </VerticalStackLayout>
            </Frame>
            
            <!-- ×¡×˜×˜×™×¡×˜×™×§×•×ª ×”×™×•× -->
            <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto" ColumnSpacing="10" RowSpacing="10">
                
                <!-- ×–××Ÿ ××¡×š -->
                <Frame Grid.Row="0" Grid.Column="0" BackgroundColor="#E3F2FD">
                    <VerticalStackLayout Spacing="5">
                        <Label Text="ğŸ“±" FontSize="32" HorizontalOptions="Center" />
                        <Label Text="{Binding TodayScreenTime, StringFormat='{0:hh\\:mm}'}"
                               FontSize="24"
                               FontAttributes="Bold"
                               HorizontalOptions="Center" />
                        <Label Text="×–××Ÿ ××¡×š ×”×™×•×"
                               FontSize="12"
                               HorizontalOptions="Center" />
                    </VerticalStackLayout>
                </Frame>
                
                <!-- ×–×™×”×•×™×™× -->
                <Frame Grid.Row="0" Grid.Column="1" BackgroundColor="#FFF3E0">
                    <VerticalStackLayout Spacing="5">
                        <Label Text="ğŸ‘‚" FontSize="32" HorizontalOptions="Center" />
                        <Label Text="{Binding TodayDetections}"
                               FontSize="24"
                               FontAttributes="Bold"
                               HorizontalOptions="Center" />
                        <Label Text="×¤× ×™×•×ª ×”×™×•×"
                               FontSize="12"
                               HorizontalOptions="Center" />
                    </VerticalStackLayout>
                </Frame>
                
                <!-- ×ª×’×•×‘×•×ª -->
                <Frame Grid.Row="1" Grid.Column="0" BackgroundColor="#E8F5E9">
                    <VerticalStackLayout Spacing="5">
                        <Label Text="âœ…" FontSize="32" HorizontalOptions="Center" />
                        <Label Text="{Binding RespondedDetections}"
                               FontSize="24"
                               FontAttributes="Bold"
                               HorizontalOptions="Center" />
                        <Label Text="×˜×•×¤×œ×•"
                               FontSize="12"
                               HorizontalOptions="Center" />
                    </VerticalStackLayout>
                </Frame>
                
                <!-- ××—×•×– ×”×™×¢× ×•×ª -->
                <Frame Grid.Row="1" Grid.Column="1" BackgroundColor="#FCE4EC">
                    <VerticalStackLayout Spacing="5">
                        <Label Text="ğŸ“Š" FontSize="32" HorizontalOptions="Center" />
                        <Label Text="{Binding RespondedDetections, Converter={StaticResource ResponseRateConverter}}"
                               FontSize="24"
                               FontAttributes="Bold"
                               HorizontalOptions="Center" />
                        <Label Text="××—×•×– ×”×™×¢× ×•×ª"
                               FontSize="12"
                               HorizontalOptions="Center" />
                    </VerticalStackLayout>
                </Frame>
                
            </Grid>
            
            <!-- ×’×¨×£ ×©×‘×•×¢×™ -->
            <Frame CornerRadius="10" Padding="10">
                <VerticalStackLayout Spacing="10">
                    <Label Text="×–××Ÿ ××¡×š - 7 ×™××™× ××—×¨×•× ×™×"
                           FontSize="16"
                           FontAttributes="Bold" />
                    
                    <lvc:CartesianChart Series="{Binding ScreenTimeSeries}"
                                        HeightRequest="250" />
                </VerticalStackLayout>
            </Frame>
            
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
```

**×ª×•×¦×¨ Phase 3:**
âœ… ×“×£ ×ª×•×‘× ×•×ª ××œ×
âœ… ××“×“ × ×•×›×—×•×ª
âœ… ×’×¨×¤×™× ×•×™×–×•××œ×™×™×
âœ… ×¡×˜×˜×™×¡×˜×™×§×•×ª ××¤×•×¨×˜×•×ª

---

### Phase 4: ×”×ª×¨××•×ª ××ª×§×“××•×ª ×•×¨×™×¦×” ×‘×¨×§×¢ (×©×‘×•×¢×•×ª 11-13)

**××˜×¨×•×ª:**
- Foreground Service ×œ-Android
- ×”×ª×¨××•×ª overlay ××¡×š ××œ×
- ×¨××•×ª ×”×ª×¨××” ××“×•×¨×’×•×ª

#### Week 11: Android Foreground Service

**11.1 ×™×¦×™×¨×ª Foreground Service**

`Platforms/Android/Services/MonitoringForegroundService.cs`:
```csharp
using Android.App;
using Android.Content;
using Android.OS;
using AndroidX.Core.App;

[Service(ForegroundServiceType = Android.Content.PM.ForegroundService.TypeMicrophone)]
public class MonitoringForegroundService : Service
{
    private const int ServiceNotificationId = 1000;
    private const string ChannelId = "monitoring_channel";
    
    private IAudioMonitorService _audioMonitor;
    private IScreenMonitorService _screenMonitor;
    
    public override IBinder OnBind(Intent intent) => null;
    
    public override StartCommandResult OnStartCommand(Intent intent, StartCommandFlags flags, int startId)
    {
        CreateNotificationChannel();
        
        var notification = new NotificationCompat.Builder(this, ChannelId)
            .SetContentTitle("×›××Ÿ ×‘×©×‘×™×œ×š ×¤×¢×™×œ")
            .SetContentText("×××–×™×Ÿ ×œ×¤× ×™×•×ª ×”×™×œ×“×™× ×©×œ×š")
            .SetSmallIcon(Resource.Drawable.ic_notification)
            .SetOngoing(true)
            .SetPriority(NotificationCompat.PriorityLow)
            .Build();
        
        StartForeground(ServiceNotificationId, notification);
        
        // ××ª×—×•×œ services
        _audioMonitor = IPlatformApplication.Current.Services
            .GetService<IAudioMonitorService>();
        _screenMonitor = IPlatformApplication.Current.Services
            .GetService<IScreenMonitorService>();
        
        Task.Run(async () =>
        {
            await _audioMonitor.StartMonitoringAsync();
            await _screenMonitor.StartMonitoringAsync();
        });
        
        return StartCommandResult.Sticky;
    }
    
    public override void OnDestroy()
    {
        Task.Run(async () =>
        {
            await _audioMonitor?.StopMonitoringAsync();
            await _screenMonitor?.StopMonitoringAsync();
        });
        
        base.OnDestroy();
    }
    
    private void CreateNotificationChannel()
    {
        if (Build.VERSION.SdkInt >= BuildVersionCodes.O)
        {
            var channel = new NotificationChannel(
                ChannelId,
                "× ×™×˜×•×¨ ×¨×§×¢",
                NotificationImportance.Low
            )
            {
                Description = "×××¤×©×¨ ×œ××¤×œ×™×§×¦×™×” ×œ×¨×•×¥ ×‘×¨×§×¢"
            };
            
            var notificationManager = (NotificationManager)GetSystemService(NotificationService);
            notificationManager.CreateNotificationChannel(channel);
        }
    }
}
```

#### Week 12-13: Overlay Notifications

**12.1 ×™×¦×™×¨×ª Overlay Window Service**

`Platforms/Android/Services/OverlayNotificationService.cs`:
```csharp
using Android.Graphics;
using Android.Views;
using Android.Widget;

public class OverlayNotificationService
{
    private readonly Context _context;
    private IWindowManager _windowManager;
    private View _overlayView;
    private bool _isShowing;
    
    public OverlayNotificationService()
    {
        _context = Android.App.Application.Context;
        _windowManager = _context.GetSystemService(Context.WindowService)
            .JavaCast<IWindowManager>();
    }
    
    public void ShowFullScreenAlert(string title, string message, AlertLevel level)
    {
        if (_isShowing) return;
        
        // ×‘×“×™×§×ª ×”×¨×©××”
        if (!Android.Provider.Settings.CanDrawOverlays(_context))
        {
            RequestOverlayPermission();
            return;
        }
        
        MainThread.BeginInvokeOnMainThread(() =>
        {
            CreateOverlayView(title, message, level);
            _isShowing = true;
        });
    }
    
    private void CreateOverlayView(string title, string message, AlertLevel level)
    {
        // ×¤×¨××˜×¨×™× ×œ×—×œ×•×Ÿ
        var layoutParams = new WindowManagerLayoutParams(
            WindowManagerLayoutParams.MatchParent,
            WindowManagerLayoutParams.MatchParent,
            Build.VERSION.SdkInt >= BuildVersionCodes.O
                ? WindowManagerTypes.ApplicationOverlay
                : WindowManagerTypes.Phone,
            WindowManagerFlags.NotFocusable | 
            WindowManagerFlags.LayoutInScreen |
            WindowManagerFlags.KeepScreenOn,
            Format.Translucent
        );
        
        // ×™×¦×™×¨×ª Layout
        var linearLayout = new LinearLayout(_context)
        {
            Orientation = Orientation.Vertical,
            LayoutParameters = new ViewGroup.LayoutParams(
                ViewGroup.LayoutParams.MatchParent,
                ViewGroup.LayoutParams.MatchParent
            )
        };
        
        linearLayout.SetBackgroundColor(level == AlertLevel.Critical 
            ? Color.Argb(230, 244, 67, 54)   // ××“×•× ×©×§×•×£
            : Color.Argb(230, 255, 152, 0)); // ×›×ª×•× ×©×§×•×£
        
        linearLayout.SetGravity(GravityFlags.Center);
        linearLayout.SetPadding(40, 40, 40, 40);
        
        // ×˜×§×¡×˜ ×›×•×ª×¨×ª
        var titleView = new TextView(_context)
        {
            Text = title,
            TextSize = 32,
            Gravity = GravityFlags.Center
        };
        titleView.SetTextColor(Color.White);
        titleView.SetTypeface(null, TypefaceStyle.Bold);
        
        // ×˜×§×¡×˜ ×”×•×“×¢×”
        var messageView = new TextView(_context)
        {
            Text = message,
            TextSize = 24,
            Gravity = GravityFlags.Center
        };
        messageView.SetTextColor(Color.White);
        messageView.SetPadding(0, 20, 0, 40);
        
        // ×›×¤×ª×•×¨×™×
        var buttonLayout = new LinearLayout(_context)
        {
            Orientation = Orientation.Horizontal
        };
        
        var dismissButton = new Button(_context)
        {
            Text = "×× ×™ ××˜×¤×œ ×‘×–×”",
            LayoutParameters = new LinearLayout.LayoutParams(
                0,
                ViewGroup.LayoutParams.WrapContent,
                1.0f
            )
        };
        dismissButton.Click += (s, e) => DismissOverlay(true);
        
        var snoozeButton = new Button(_context)
        {
            Text = "×¢×•×“ ×¨×’×¢",
            LayoutParameters = new LinearLayout.LayoutParams(
                0,
                ViewGroup.LayoutParams.WrapContent,
                1.0f
            )
        };
        snoozeButton.Click += (s, e) => DismissOverlay(false);
        
        buttonLayout.AddView(dismissButton);
        buttonLayout.AddView(snoozeButton);
        
        linearLayout.AddView(titleView);
        linearLayout.AddView(messageView);
        linearLayout.AddView(buttonLayout);
        
        _overlayView = linearLayout;
        _windowManager.AddView(_overlayView, layoutParams);
    }
    
    private void DismissOverlay(bool handled)
    {
        if (_overlayView != null)
        {
            _windowManager.RemoveView(_overlayView);
            _overlayView = null;
            _isShowing = false;
        }
        
        // TODO: ×¢×“×›×Ÿ ×‘-database ×× ×˜×•×¤×œ ××• ×œ×
    }
    
    private void RequestOverlayPermission()
    {
        var intent = new Intent(
            Android.Provider.Settings.ActionManageOverlayPermission,
            Android.Net.Uri.Parse($"package:{_context.PackageName}")
        );
        intent.SetFlags(ActivityFlags.NewTask);
        _context.StartActivity(intent);
    }
}
```

**×ª×•×¦×¨ Phase 4:**
âœ… Foreground service ×¨×¥ ×‘×¨×§×¢
âœ… Overlay notifications ××¡×š ××œ×
âœ… ×›×¤×ª×•×¨×™× "×˜×™×¤×œ×ª×™" / "×¨×’×¢"
âœ… ×”×”×¨×©××•×ª ×”× ×“×¨×©×•×ª

---

### Phase 5: ×”×’×“×¨×•×ª ××ª×§×“××•×ª ×•×›×™×•×œ×™× (×©×‘×•×¢×•×ª 14-16)

**××˜×¨×•×ª:**
- ××™××•×Ÿ ××™×œ×•×ª ××¤×ª×— ××•×ª×××•×ª ××™×©×™×ª
- ×”×’×“×¨×•×ª ×¡×£ ×–×™×”×•×™
- ×¤×¨×•×¤×™×œ×™× ×œ××©×¤×—×”

**×ª×•×¦×¨ Phase 5:**
âœ… ×”×’×“×¨×•×ª ××ª×§×“××•×ª
âœ… ×›×™×•×œ ×¨×’×™×©×•×ª
âœ… ×ª××™×›×” ×‘××¡×¤×¨ ×™×œ×“×™×

---

### Phase 6: iOS Support ×•×¤×™×¦'×¨×™× × ×•×¡×¤×™× (×©×‘×•×¢×•×ª 17-20)

**××˜×¨×•×ª:**
- ×¤×™×ª×•×— ×’×¨×¡×ª iOS
- ×–×™×”×•×™ × ×•×›×—×•×ª (camera)
- Co-parenting sync

**×ª×•×¦×¨ Phase 6:**
âœ… ×ª××™×›×” ×‘-iOS
âœ… Sync ×‘×™×Ÿ ××›×©×™×¨×™× (P2P)
âœ… ×–×™×”×•×™ ×¤×™×–×™ ×‘×—×“×¨

---

### Phase 7: ×‘×“×™×§×•×ª, ×œ×™×˜×•×© ×•×¤×¨×¡×•× (×©×‘×•×¢×•×ª 21-24)

**××˜×¨×•×ª:**
- Unit tests
- Beta testing ×¢× ××©×¤×—×•×ª ×××™×ª×™×•×ª
- ××•×¤×˜×™××™×–×¦×™×™×ª ×¡×•×œ×œ×”
- ×¤×¨×¡×•× ×œ-Play Store / App Store

---

## ğŸ“Š ××™×œ×¡×˜×•× ×™× ×•××“×“×™ ×”×¦×œ×—×”

### Milestone 1 (×¡×•×£ ×—×•×“×© 1)
- âœ… ××¤×œ×™×§×¦×™×” ×¨×¦×” ×¢×œ Android
- âœ… ××–×”×” ××™×œ×” ××—×ª
- âœ… ××¨××” ×”×ª×¨××”

### Milestone 2 (×¡×•×£ ×—×•×“×© 2)
- âœ… × ×™×˜×•×¨ ×–××Ÿ ××¡×š
- âœ… ×©××™×¨×ª ×”×™×¡×˜×•×¨×™×”
- âœ… 3 ××©×ª××©×™ beta ×‘×•×“×§×™×

### Milestone 3 (×¡×•×£ ×—×•×“×© 3)
- âœ… ×“×£ ×ª×•×‘× ×•×ª ××œ×
- âœ… Foreground service ×™×¦×™×‘
- âœ… 10 ××©×ª××©×™ beta ×‘×•×“×§×™×

### Milestone 4 (×¡×•×£ ×—×•×“×© 4)
- âœ… ×”×’×“×¨×•×ª ××œ××•×ª
- âœ… ××™××•×Ÿ ××™×œ×•×ª ××¤×ª×— ××•×ª×××•×ª
- âœ… 50 ××©×ª××©×™ beta

### Milestone 5 (×¡×•×£ ×—×•×“×© 5)
- âœ… ×’×¨×¡×ª iOS
- âœ… Sync ×‘×™×Ÿ ××›×©×™×¨×™×
- âœ… 100+ ××©×ª××©×™×

### Milestone 6 (×¡×•×£ ×—×•×“×© 6)
- âœ… ×¤×¨×¡×•× ×‘-Play Store
- âœ… App Store review
- âœ… ×“×•×§×•×× ×˜×¦×™×” ××œ××”

---

## ğŸ› ï¸ ×›×œ×™× ×•××©××‘×™×

### ×œ××™×“×”
- **Microsoft Learn**: .NET MAUI Tutorials
- **YouTube**: James Montemagno - .NET MAUI Playlist
- **GitHub**: microsoft/dotnet-maui-samples
- **Picovoice Docs**: https://picovoice.ai/docs/

### Packages ××¨×›×–×™×™×
```xml
<!-- .csproj -->
<ItemGroup>
    <!-- Core -->
    <PackageReference Include="CommunityToolkit.Mvvm" Version="8.2.2" />
    <PackageReference Include="CommunityToolkit.Maui" Version="7.0.0" />
    
    <!-- Database -->
    <PackageReference Include="sqlite-net-pcl" Version="1.9.172" />
    <PackageReference Include="SQLitePCLRaw.bundle_green" Version="2.1.8" />
    
    <!-- Voice Detection -->
    <PackageReference Include="Picovoice.Porcupine" Version="3.0.0" />
    
    <!-- Charts -->
    <PackageReference Include="LiveChartsCore.SkiaSharpView.Maui" Version="2.0.0-rc2" />
    
    <!-- Permissions -->
    <PackageReference Include="Microsoft.Maui.Essentials" Version="8.0.0" />
</ItemGroup>
```

### ×˜×™×¤×™× ×œ×¤×™×ª×•×—
1. **×”×ª×—×œ ×¢× Android**: iOS ××¡×•×‘×š ×™×•×ª×¨ ×¢× ×”×¨×©××•×ª
2. **×”×©×ª××© ×‘-Hot Reload**: ×—×•×¡×š ×”××•×Ÿ ×–××Ÿ
3. **×‘×“×•×§ ×¢×œ ××›×©×™×¨ ×××™×ª×™**: Emulator ×œ× ××“×•×™×§ ×œ××™×§×¨×•×¤×•×Ÿ
4. **×œ×•×’ ×”×›×œ**: Debug.WriteLine ×”×•× ×”×—×‘×¨ ×©×œ×š
5. **×©××•×¨ ×§×•×“ shared**: ×›×œ ××” ×©××¤×©×¨ ×‘-Shared Project

---

## ğŸ’° ××•××“×Ÿ ×¢×œ×•×™×•×ª

### ×¤×™×ª×•×— (×‘×”× ×—×” ×©××ª×” ×¢×•×©×” ×œ×‘×“)
- **×–××Ÿ**: 6 ×—×•×“×©×™×, ~20 ×©×¢×•×ª/×©×‘×•×¢ = 480 ×©×¢×•×ª
- **×¢×œ×•×ª ×–××Ÿ** (×× ×”×™×™×ª ××—×©×‘ $50/×©×¢×”): $24,000

### ×›×œ×™× ×•×©×™×¨×•×ª×™×
- **Visual Studio**: ×—×™× × (Community Edition)
- **Picovoice Free Tier**: ×—×™× × ×œ-3 ××™×œ×•×ª ××¤×ª×— ××•×ª×××•×ª
- **Azure** (××•×¤×¦×™×•× ×œ×™): $0-50/×—×•×“×© (×× ×¦×¨×™×š backend)
- **Google Play Developer**: $25 ×—×“ ×¤×¢××™
- **Apple Developer**: $99/×©× ×”
- **×©××™×¨×ª ×“×•××™×™×Ÿ**: ~$15/×©× ×”

**×¡×”"×› ×©× ×” ×¨××©×•× ×”**: ~$200-300

### Scale (×× ××ª×›× ×Ÿ ×œ××¡×—×¨)
- **Picovoice Enterprise**: ××©×ª× ×” ×œ×¤×™ ×©×™××•×©
- **Backend hosting**: $50-500/×—×•×“×© ×ª×œ×•×™ ×‘×›××•×ª ××©×ª××©×™×
- **××©×¤×˜×™/×—×‘×¨×”**: $1,000-5,000

---

## âš ï¸ ××ª×’×¨×™× ×¦×¤×•×™×™×

### 1. iOS Limitations
**×‘×¢×™×”**: iOS ×œ× ×××¤×©×¨×ª ×¨×™×¦×” ×‘×¨×§×¢ ×›××• Android
**×¤×ª×¨×•×Ÿ**: 
- Background Audio mode (×œ×”×ª×—×–×•×ª ×œ"× ×’×Ÿ")
- Focus Modes + Shortcuts
- Widget ×©××ª×¢×“×›×Ÿ

### 2. Battery Drain
**×‘×¢×™×”**: × ×™×˜×•×¨ ××™×§×¨×•×¤×•×Ÿ ××ª××™×“ ××¨×•×§×Ÿ ×¡×•×œ×œ×”
**×¤×ª×¨×•×Ÿ**:
- Voice Activity Detection (VAD) ×§×•×“×
- ×“×’×™××” ×—×›××” (×œ× ×¨×¦×™×¤×”)
- Sleep modes ×›×©××¡×š ×›×‘×•×™

### 3. False Positives
**×‘×¢×™×”**: ×–×™×”×•×™ ××™×œ×™× ×‘×˜×¢×•×ª (×˜×œ×•×•×™×–×™×”, ×¨×“×™×•)
**×¤×ª×¨×•×Ÿ**:
- Speaker identification (×–×™×”×•×™ ×“×•×‘×¨ ×¡×¤×¦×™×¤×™)
- Context awareness (×–××Ÿ, ××™×§×•×)
- ×”×’×“×¨×•×ª ×¨×’×™×©×•×ª

### 4. Privacy Concerns
**×‘×¢×™×”**: ×”×•×¨×™× ×™×¤×—×“×• ××”×§×œ×˜×”
**×¤×ª×¨×•×Ÿ**:
- 100% on-device processing
- ××™×Ÿ ×©××™×¨×ª ××•×“×™×•
- ×§×•×“ ×¤×ª×•×— (××•×¤×¦×™×”)
- ×“×•×§×•×× ×˜×¦×™×” ×‘×¨×•×¨×”

---

## ğŸš€ ×œ××—×¨ ×”-MVP - ×›×™×•×•× ×™× ×¢×ª×™×“×™×™×

1. **AI Emotion Detection**: ×–×™×”×•×™ ××¦×•×§×”/×›×¢×¡ ×‘×§×•×œ
2. **Smart Home Integration**: ×¢××¢×•× ××•×¨×•×ª ×›×©××–×”×” ×¤× ×™×”
3. **Wearable Support**: ×”×ª×¨××•×ª ×œ-smartwatch
4. **Family Dashboard**: ×ª×¦×•×’×” ××©×•×ª×¤×ª ×œ×©× ×™ ×”×•×¨×™×
5. **Gamification**: × ×§×•×“×•×ª ×•×”×™×©×’×™× ×œ××©×¤×—×”
6. **×ª××™×›×ª ×§×”×™×œ×”**: ×©×™×ª×•×£ ×˜×™×¤×™× ×‘×™×Ÿ ×”×•×¨×™×
7. **××™× ×˜×’×¨×¦×™×™×ª ×™×•××Ÿ**: Notion, Google Calendar
8. **AI Coach**: ×”××œ×¦×•×ª ××•×ª×××•×ª ××™×©×™×ª

---

## ğŸ“ ×”×¢×¨×•×ª ×—×©×•×‘×•×ª ×œ×¤× ×™ ×©××ª×—×™×œ×™×

### ××” ×›×“××™ ×œ×“×¢×ª ××¨××©:
1. **C# ×©××ª×” ××›×™×¨ != C# ×‘-MAUI**: ×™×© × ×™×•×× ×¡×™× (async/await, lifecycle)
2. **XAML ×œ×•×§×— ×–××Ÿ**: ××‘×œ ×™×© Designer ×•-Hot Reload
3. **Android Emulator ××™×˜×™**: ×”×©×§×¢ ×‘××›×©×™×¨ ×××™×ª×™ ×œ×¤×™×ª×•×—
4. **×”×¨×©××•×ª ××¢×¦×‘× ×•×ª**: ×”×›×Ÿ ×¡×‘×œ× ×•×ª ×œ× ×™×¤×•×™ ×‘××’×™×
5. **Community ×¢×•×–×¨×ª**: Stack Overflow + Discord ×©×œ MAUI

### ××” ×©×™×¢×–×•×¨ ×œ×š (×¨×§×¢ ×‘-C#):
âœ… LINQ - ××©×ª××©×™× ×”×¨×‘×”
âœ… async/await - ×§×¨×™×˜×™
âœ… Dependency Injection - ××•×‘× ×” ×‘-MAUI
âœ… Events & Delegates - ×œ×›×œ ××§×•×
âœ… MVVM Pattern - ×”×‘×¡×™×¡ ×©×œ ×”×›×œ

---

## ğŸ“ ×ª×›× ×™×ª ×œ××™×“×” ××•××œ×¦×ª (×œ×¤× ×™ ×©××ª×—×™×œ×™× ×œ×§×•×“×“)

### ×©×‘×•×¢ 0 - Pre-learning
**×™×•× 1-2**: .NET MAUI Basics
- [Microsoft Learn - Build mobile and desktop apps with .NET MAUI](https://learn.microsoft.com/training/paths/build-apps-with-dotnet-maui/)

**×™×•× 3-4**: MVVM Pattern
- [James Montemagno - MVVM Tutorial](https://www.youtube.com/watch?v=Pso1MeX_HvI)

**×™×•× 5-7**: ×”×§××ª ×¤×¨×•×™×§×˜ ×¨××©×•×Ÿ
- ×¢×§×•×‘ ××—×¨×™ tutorial ××œ×
- ×¦×•×¨ ××¤×œ×™×§×¦×™×™×ª TODO ×¤×©×•×˜×”

---

×–×• ×ª×›× ×™×ª ××¤×•×¨×˜×ª ×××•×“, ××‘×œ ××¤×©×¨ ×œ×”×ª××™× ××•×ª×”. 

**×”×©××œ×•×ª ×©×œ×™ ××œ×™×š:**
1. ×”×× ×™×© ×œ×š Mac? (××©×¤×™×¢ ×¢×œ ×¤×™×ª×•×— iOS)
2. ×™×© ×œ×š ××›×©×™×¨ Android ×œ×‘×“×™×§×•×ª?
3. ×›××” ×–××Ÿ ×‘×©×‘×•×¢ ××ª×” ×™×›×•×œ ×œ×”×©×§×™×¢?
4. ×”×× ××ª×” ××¢×•× ×™×™×Ÿ ×‘×’×¨×¡×” ××¡×—×¨×™×ª ××• ×¨×§ ×œ×©×™××•×© ××™×©×™?

**×‘×•××• × ×ª×—×™×œ ×‘×™×—×“ - ×¨×•×¦×” ×©×× ×™:**
1. ××›×™×Ÿ ×œ×š ××ª ×”-boilerplate code ×œ×¤×¨×•×™×§×˜?
2. ××›×ª×•×‘ tutorial ××¤×•×¨×˜ ×œ-Phase 0?
3. × ×‘× ×” ×™×—×“ ××ª ×”-MVP ×”×¨××©×•×Ÿ?

××” ××ª×” ××•××¨?
